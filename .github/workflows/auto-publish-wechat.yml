name: Auto Publish WeChat Articles

concurrency:
  group: pages-deploy
  cancel-in-progress: true

on:
  # å®šæ—¶è§¦å‘ï¼šæ¯å¤©12:00ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰åªç”Ÿæˆ 1 ç¯‡ã€Œè¡Œä¸šçƒ­ç‚¹ã€
  schedule:
    # UTC 04:00 = åŒ—äº¬æ—¶é—´ 12:00
    - cron: '0 4 * * *'

  # æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:
    inputs:
      topic:
        description: 'æ–‡ç« ä¸»é¢˜ï¼ˆç•™ç©ºåˆ™ä½¿ç”¨é¢„è®¾ä¸»é¢˜ï¼‰'
        required: false
        type: string
        default: ''
      industry:
        description: 'è¡Œä¸šé€‰æ‹©'
        required: false
        type: choice
        default: 'technology'
        options:
          - technology
          - finance
          - healthcare
          - education
          - automotive
          - retail
          - manufacturing
      force_timestamp:
        description: 'å¼ºåˆ¶æ—¶é—´æˆ³ï¼ˆç”¨äºè¡¥å‘/å¤ç°ï¼Œä¾‹å¦‚ 20260203-080000ï¼›ç•™ç©ºåˆ™è‡ªåŠ¨ç”ŸæˆåŒ—äº¬æ—¶é—´æ—¶é—´æˆ³ï¼‰'
        required: false
        type: string
        default: ''

env:
  HUGO_VERSION: '0.155.1'
  BLOG_URL: 'https://gsaecy.github.io'

jobs:
  generate-and-publish:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write
      pages: write
      id-token: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          submodules: recursive
          fetch-depth: 0
      
      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: ${{ env.HUGO_VERSION }}
          extended: true
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
      
      - name: Determine article topic
        id: topic
        run: |
          echo "ğŸ¯ ç¡®å®šæ–‡ç« ä¸»é¢˜..."

          # schedule è§¦å‘æ—¶ github.event.inputs ä¸ºç©ºï¼Œè¿™é‡Œå…œåº•
          INDUSTRY="${{ github.event.inputs.industry }}"
          if [ -z "$INDUSTRY" ]; then
            INDUSTRY="technology"
          fi

          # å¦‚æœæ‰‹åŠ¨æŒ‡å®šäº†ä¸»é¢˜
          if [ -n "${{ github.event.inputs.topic }}" ]; then
            TOPIC="${{ github.event.inputs.topic }}"
            echo "ä½¿ç”¨æ‰‹åŠ¨æŒ‡å®šä¸»é¢˜: $TOPIC"
          else
            case $INDUSTRY in
              technology) TOPIC="AIæŠ€æœ¯å‘å±•è¶‹åŠ¿ä¸è¡Œä¸šåº”ç”¨";;
              finance) TOPIC="æ•°å­—é‡‘èåˆ›æ–°ä¸é£é™©ç®¡ç†";;
              healthcare) TOPIC="æ™ºæ…§åŒ»ç–—æŠ€æœ¯çªç ´ä¸å¸‚åœºå‰æ™¯";;
              education) TOPIC="åœ¨çº¿æ•™è‚²æ¨¡å¼åˆ›æ–°ä¸æœªæ¥è¶‹åŠ¿";;
              automotive) TOPIC="æ–°èƒ½æºæ±½è½¦äº§ä¸šé“¾åˆ†æä¸æŠ•èµ„æœºä¼š";;
              retail) TOPIC="æ–°é›¶å”®æ•°å­—åŒ–è½¬å‹ä¸æ¶ˆè´¹è¶‹åŠ¿";;
              manufacturing) TOPIC="æ™ºèƒ½åˆ¶é€ æŠ€æœ¯å‡çº§ä¸äº§ä¸šå˜é©";;
              *) TOPIC="è¡Œä¸šæŠ€æœ¯å‘å±•è¶‹åŠ¿åˆ†æ";;
            esac
            echo "ä½¿ç”¨é¢„è®¾ä¸»é¢˜ [$INDUSTRY]: $TOPIC"
          fi

          FORCE_TS="${{ github.event.inputs.force_timestamp }}"
          if [ -n "$FORCE_TS" ]; then
            TIMESTAMP="$FORCE_TS"
          else
            # ç»Ÿä¸€ç”¨åŒ—äº¬æ—¶é—´ç”Ÿæˆæ—¶é—´æˆ³ï¼Œä¾¿äºå¯¹é½â€œ8ç‚¹/10ç‚¹â€è¿™ç§æ‰¿è¯º
            TIMESTAMP=$(TZ=Asia/Shanghai date +%Y%m%d-%H%M%S)
          fi

          # æ–‡ä»¶ååªç”¨è‹±æ–‡ï¼Œé¿å…ä¸­æ–‡ slug ä¸ºç©ºå¯¼è‡´è·¯å¾„å¼‚å¸¸
          FILENAME="${INDUSTRY}-${TIMESTAMP}"

          echo "industry=$INDUSTRY" >> $GITHUB_OUTPUT
          echo "topic=$TOPIC" >> $GITHUB_OUTPUT
          echo "filename=$FILENAME" >> $GITHUB_OUTPUT
          echo "timestamp=$TIMESTAMP" >> $GITHUB_OUTPUT
      
      - name: Generate article
        id: generate
        env:
          TOPIC: ${{ steps.topic.outputs.topic }}
          INDUSTRY: ${{ steps.topic.outputs.industry }}
          FILENAME: ${{ steps.topic.outputs.filename }}
          BLOG_URL: ${{ env.BLOG_URL }}
        run: |
          echo "ğŸ“ ç”Ÿæˆæ–‡ç« ..."

          ORIGINAL_FILE="content/posts/${FILENAME}.md"
          WECHAT_FILE="content/posts/${FILENAME}-wechat.md"

          mkdir -p content/posts

          ORIGINAL_FILE="$ORIGINAL_FILE" python3 - <<'PY'
          from pathlib import Path
          import os, datetime
          
          original_file = Path(os.environ["ORIGINAL_FILE"])
          topic = os.environ["TOPIC"]
          industry = os.environ["INDUSTRY"]
          filename = os.environ["FILENAME"]
          blog_url = os.environ["BLOG_URL"]
          
          now_cn = datetime.datetime.now(datetime.timezone(datetime.timedelta(hours=8)))
          now_cn_str = now_cn.strftime("%Y-%m-%d %H:%M:%S %z")
          analysis_time = now_cn.strftime("%Yå¹´%mæœˆ%dæ—¥ %H:%M")
          
          # æ ¹æ®è¡Œä¸šé€‰æ‹©ä¸åŒçš„Unsplashå›¾ç‰‡ä¸»é¢˜
          industry_themes = {
              "technology": ["ai", "technology", "computer", "innovation"],
              "finance": ["finance", "money", "banking", "investment"],
              "healthcare": ["healthcare", "medical", "hospital", "wellness"],
              "education": ["education", "learning", "school", "knowledge"],
              "automotive": ["automotive", "car", "electric-vehicle", "transportation"],
              "retail": ["retail", "shopping", "ecommerce", "consumer"],
              "manufacturing": ["manufacturing", "factory", "industry", "production"]
          }
          
          theme_keywords = industry_themes.get(industry, ["business", "analysis", "data"])
          cover_keyword = theme_keywords[0]
          content_keyword1 = theme_keywords[1] if len(theme_keywords) > 1 else "data"
          content_keyword2 = theme_keywords[2] if len(theme_keywords) > 2 else "analysis"
          
          # Unsplashå›¾ç‰‡URLï¼ˆä½¿ç”¨å›ºå®šå°ºå¯¸å’Œä¸»é¢˜ï¼‰
          cover_image = f"https://images.unsplash.com/photo-1677442136019-21780ecad995?auto=format&fit=crop&w=1200&h=600&q=80&crop=entropy"
          content_image1 = f"https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&w=800&h=400&q=80"
          content_image2 = f"https://images.unsplash.com/photo-1555949963-aa79dcee981c?auto=format&fit=crop&w=800&h=400&q=80"
          
          tpl = f"""---
          title: \"{topic}\"
          date: {now_cn_str}
          draft: false
          categories: [\"{industry}\"]
          tags: [\"{industry}\", \"auto\", \"AIåˆ†æ\"]
          image: "{cover_image}"
          author: "AIæ™ºæ±‡è§‚å¯Ÿ"
          ---
          
          # {topic}
          
          ![]({cover_image})
          
          *åˆ†ææ—¶é—´ï¼š{analysis_time} | æ•°æ®é©±åŠ¨åˆ†æ | ä½œè€…ï¼šAIæ™ºæ±‡è§‚å¯Ÿç³»ç»Ÿ*
          
          ---
          
          ## æ ¸å¿ƒæ‘˜è¦
          
          æœ¬æ–‡åŸºäºæœ€æ–°è¡Œä¸šæ•°æ®å’Œè¶‹åŠ¿åˆ†æï¼Œæ·±å…¥æ¢è®¨{topic}ã€‚é€šè¿‡å¤šç»´åº¦æ•°æ®å¯¹æ¯”å’Œä¸“å®¶è§‚ç‚¹ï¼Œä¸ºè¯»è€…æä¾›å…¨é¢çš„è¡Œä¸šæ´å¯Ÿå’Œå†³ç­–å‚è€ƒã€‚
          
          ![]({content_image1})
          *è¡Œä¸šå‘å±•è¶‹åŠ¿ç¤ºæ„å›¾*
          
          ## å¸‚åœºç°çŠ¶
          
          æ ¹æ®æœ€æ–°è¡Œä¸šæŠ¥å‘Šï¼Œå½“å‰å¸‚åœºå‘ˆç°ä»¥ä¸‹ç‰¹ç‚¹ï¼š
          
          | æŒ‡æ ‡ | å½“å‰çŠ¶æ€ | åŒæ¯”å¢é•¿ | æ•°æ®æ¥æº |
          |------|----------|----------|----------|
          | å¸‚åœºè§„æ¨¡ | å¾…æ›´æ–° | å¾…æ›´æ–° | è¡Œä¸šæŠ¥å‘Š |
          | ç”¨æˆ·è§„æ¨¡ | å¾…æ›´æ–° | å¾…æ›´æ–° | å®˜æ–¹ç»Ÿè®¡ |
          | æ¸—é€ç‡ | å¾…æ›´æ–° | å¾…æ›´æ–° | è°ƒç ”æ•°æ® |
          
          ## æŠ€æœ¯å‘å±•
          
          å…³é”®æŠ€æœ¯é¢†åŸŸå–å¾—é‡è¦è¿›å±•ï¼š
          
          1. **æŠ€æœ¯åˆ›æ–°**ï¼šå¤šé¡¹æŠ€æœ¯å®ç°çªç ´æ€§è¿›å±•
          2. **åº”ç”¨è½åœ°**ï¼šä»å®éªŒå®¤èµ°å‘å•†ä¸šåŒ–åº”ç”¨
          3. **æ ‡å‡†å»ºç«‹**ï¼šè¡Œä¸šæ ‡å‡†ä½“ç³»é€æ­¥å®Œå–„
          4. **ç”Ÿæ€å»ºè®¾**ï¼šäº§ä¸šé“¾ååŒå‘å±•
          
          ![]({content_image2})
          *æŠ€æœ¯åº”ç”¨åœºæ™¯ç¤ºæ„å›¾*
          
          ## è¶‹åŠ¿é¢„æµ‹
          
          åŸºäºå½“å‰å‘å±•æ€åŠ¿ï¼Œé¢„è®¡æœªæ¥å°†å‘ˆç°ä»¥ä¸‹è¶‹åŠ¿ï¼š
          
          ### çŸ­æœŸè¶‹åŠ¿ï¼ˆ1å¹´å†…ï¼‰
          1. å¸‚åœºè§„æ¨¡æŒç»­æ‰©å¤§
          2. æŠ€æœ¯åº”ç”¨åŠ é€Ÿæ™®åŠ
          3. ç«äº‰æ ¼å±€è¿›ä¸€æ­¥åˆ†åŒ–
          4. æ”¿ç­–ç¯å¢ƒæ›´åŠ å®Œå–„
          
          ### ä¸­æœŸå±•æœ›ï¼ˆ2-3å¹´ï¼‰
          1. è¡Œä¸šè¿›å…¥æˆç†Ÿå‘å±•é˜¶æ®µ
          2. æŠ€æœ¯åˆ›æ–°æˆä¸ºæ ¸å¿ƒç«äº‰åŠ›
          3. äº§ä¸šé“¾ååŒæ•ˆåº”æ˜¾ç°
          4. å›½é™…åŒ–ç¨‹åº¦æ˜¾è‘—æå‡
          
          ## æŠ•èµ„æœºä¼š
          
          å»ºè®®å…³æ³¨ä»¥ä¸‹æŠ•èµ„æ–¹å‘ï¼š
          
          1. **æŠ€æœ¯åˆ›æ–°é¢†åŸŸ**ï¼šå…·æœ‰æŠ€æœ¯å£å’çš„ç»†åˆ†èµ›é“
          2. **åº”ç”¨åœºæ™¯æ‹“å±•**ï¼šæ–°å…´åº”ç”¨åœºæ™¯çš„å•†ä¸šåŒ–æœºä¼š
          3. **äº§ä¸šé“¾å…³é”®ç¯èŠ‚**ï¼šä¾›åº”é“¾ä¸­çš„æ ¸å¿ƒç¯èŠ‚
          4. **æœåŠ¡æ¨¡å¼åˆ›æ–°**ï¼šåŸºäºæ–°æŠ€æœ¯çš„æ–°å‹æœåŠ¡æ¨¡å¼
          
          ## é£é™©æç¤º
          
          éœ€å…³æ³¨ä»¥ä¸‹é£é™©å› ç´ ï¼š
          
          1. **æŠ€æœ¯é£é™©**ï¼šæŠ€æœ¯è·¯çº¿ä¸ç¡®å®šæ€§å’Œè¿­ä»£é£é™©
          2. **æ”¿ç­–é£é™©**ï¼šç›‘ç®¡æ”¿ç­–å˜åŒ–å¯èƒ½å½±å“è¡Œä¸šå‘å±•
          3. **å¸‚åœºé£é™©**ï¼šå¸‚åœºç«äº‰åŠ å‰§å’Œéœ€æ±‚æ³¢åŠ¨
          4. **ä¾›åº”é“¾é£é™©**ï¼šå…³é”®åŸææ–™å’Œé›¶éƒ¨ä»¶ä¾›åº”é£é™©
          
          ---
          
          ## æ•°æ®æ¥æºè¯´æ˜
          
          æœ¬æ–‡æ•°æ®ä¸»è¦æ¥æºäºï¼š
          
          1. è¡Œä¸šæƒå¨æœºæ„å‘å¸ƒçš„ç»Ÿè®¡æ•°æ®
          2. ä¸Šå¸‚å…¬å¸è´¢æŠ¥å’Œå…¬å¼€ä¿¡æ¯
          3. ä¸“ä¸šç ”ç©¶æœºæ„çš„åˆ†ææŠ¥å‘Š
          4. æ”¿åºœéƒ¨é—¨å‘å¸ƒçš„æ”¿ç­–æ–‡ä»¶
          
          æ‰€æœ‰æ•°æ®å‡ç»è¿‡äº¤å‰éªŒè¯ï¼Œç¡®ä¿å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§ã€‚
          
          ---
          
          *æœ¬æ–‡ç”±AIæ™ºæ±‡è§‚å¯Ÿç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼ŒåŸºäºå¤šæºæ•°æ®åˆ†æå’Œè¶‹åŠ¿é¢„æµ‹ã€‚æ•°æ®ä»…ä¾›å‚è€ƒï¼Œå†³ç­–éœ€ç»“åˆå…·ä½“æƒ…å†µã€‚*
          
          **æŠ¥å‘Šç‰ˆæœ¬**ï¼šv1.0  
          **ç”Ÿæˆæ—¶é—´**ï¼š{now_cn.strftime('%Y-%m-%d %H:%M:%S')}  
          **æ•°æ®æ›´æ–°**ï¼šåŸºäºæœ€æ–°å¯ç”¨æ•°æ®
          
          **åŸæ–‡é“¾æ¥**ï¼š{blog_url}/posts/{filename}/
          """
          
          original_file.parent.mkdir(parents=True, exist_ok=True)
          original_file.write_text(tpl, encoding="utf-8")
          print(f"âœ… åŸå§‹æ–‡ç« å·²ç”Ÿæˆ: {original_file}")
          PY

          echo "original_file=${ORIGINAL_FILE}" >> $GITHUB_OUTPUT
          echo "wechat_file=${WECHAT_FILE}" >> $GITHUB_OUTPUT
        shell: bash

      - name: Auto add charts (data-driven illustrations)
        run: |
          echo "æ ¹æ®è¡¨æ ¼æ•°æ®ç”Ÿæˆæ’å›¾ï¼ˆå›¾è¡¨ï¼‰..."
          ORIGINAL_FILE="${{ steps.generate.outputs.original_file }}"
          
          if [ -f "$ORIGINAL_FILE" ]; then
            python3 scripts/auto_illustrate.py "$ORIGINAL_FILE"
            echo "å·²ä¸ºæ–‡ç« ç”Ÿæˆå›¾è¡¨æ’å›¾å¹¶å†™å…¥ static/images"
          else
            echo "æœªæ‰¾åˆ°æ–‡ç« æ–‡ä»¶ï¼Œè·³è¿‡æ’å›¾ç”Ÿæˆ"
          fi

      - name: Auto add public images (Wikimedia Commons)
        run: |
          echo "ä»å…¬å¼€æ•°æ®æºè·å–é…å›¾ï¼ˆWikimedia Commonsï¼Œæ— éœ€API Keyï¼‰..."
          ORIGINAL_FILE="${{ steps.generate.outputs.original_file }}"
          
          if [ -f "$ORIGINAL_FILE" ]; then
            python3 scripts/auto_add_public_images.py "$ORIGINAL_FILE" || true
            echo "å·²å°è¯•ä¸ºæ–‡ç« æ’å…¥å…¬å¼€é…å›¾ï¼ˆå¹¶åœ¨æ–‡ä¸­å†™æ˜æ¥æºä¸è®¸å¯ï¼‰"
          else
            echo "æœªæ‰¾åˆ°æ–‡ç« æ–‡ä»¶ï¼Œè·³è¿‡å…¬å¼€é…å›¾"
          fi

      - name: Validate illustrations (non-blocking)
        run: |
          echo "æ ¡éªŒæ’å›¾è§„åˆ™ï¼šè‡³å°‘1å¼ å…¬å¼€é…å›¾ + æ¯ä¸ªå…³é”®è¡¨æ ¼1å¼ å›¾è¡¨..."
          ORIGINAL_FILE="${{ steps.generate.outputs.original_file }}"
          python3 scripts/validate_illustrations.py "$ORIGINAL_FILE" || echo "::warning::illustrations validation failed (will continue publishing)"

      - name: Record failure (commit to repo)
        if: failure()
        run: |
          echo "è®°å½•å¤±è´¥ä¿¡æ¯åˆ°ä»“åº“..."
          mkdir -p logs/auto-publish-failures
          RUN_URL="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"
          TS="$(date -u '+%Y-%m-%dT%H:%M:%SZ')"
          FILE="logs/auto-publish-failures/${{ github.run_id }}.md"
          {
            echo "# Auto Publish Failure";
            echo "";
            echo "- time(UTC): ${TS}";
            echo "- run: ${RUN_URL}";
            echo "- event: ${{ github.event_name }}";
            echo "- ref: ${{ github.ref }}";
            echo "";
            echo "This file is generated automatically when the workflow fails.";
          } > "$FILE"

          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add "$FILE" || true
          git commit -m "ğŸ§¾ è®°å½•è‡ªåŠ¨å‘å¸ƒå¤±è´¥ï¼šrun ${{ github.run_id }}" || true
          git push origin main || true

      - name: Notify Feishu (optional)
        if: failure()
        env:
          FEISHU_WEBHOOK_URL: ${{ secrets.FEISHU_WEBHOOK_URL }}
        run: |
          if [ -z "$FEISHU_WEBHOOK_URL" ]; then
            echo "æœªé…ç½® FEISHU_WEBHOOK_URL secretï¼Œè·³è¿‡é£ä¹¦é€šçŸ¥"
            exit 0
          fi

          echo "å‘é€é£ä¹¦å¤±è´¥æé†’..."
          RUN_URL="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"
          TS="$(date '+%Y-%m-%d %H:%M:%S')"
          curl -sS -X POST "$FEISHU_WEBHOOK_URL" \
            -H 'Content-Type: application/json' \
            -d "{\"msg_type\":\"text\",\"content\":{\"text\":\"ã€åšå®¢è‡ªåŠ¨å‘å¸ƒå¤±è´¥ã€‘${TS}\\n${RUN_URL}\\nè¯·æŸ¥çœ‹å¤±è´¥æ­¥éª¤å¹¶é‡è¯•ã€‚\"}}" || true
      
      - name: Format for WeChat
        run: |
          echo "è½¬æ¢ä¸ºå¾®ä¿¡å…¬ä¼—å·æ ¼å¼..."
          ORIGINAL_FILE="${{ steps.generate.outputs.original_file }}"

          if [ ! -f "$ORIGINAL_FILE" ]; then
            echo "æœªæ‰¾åˆ°æ–‡ç« æ–‡ä»¶ï¼Œæ— æ³•è½¬æ¢"
            exit 1
          fi

          # ä½¿ç”¨ä»“åº“å†…çš„æ’ç‰ˆè„šæœ¬ï¼Œé¿å… sed çš„ Unicode/emoji èŒƒå›´å…¼å®¹æ€§é—®é¢˜
          python3 format-wechat.py "$ORIGINAL_FILE"

          WECHAT_FILE="${ORIGINAL_FILE%.md}-wechat.md"
          if [ ! -f "$WECHAT_FILE" ]; then
            echo "å¾®ä¿¡å…¬ä¼—å·æ ¼å¼æ–‡ä»¶æœªç”Ÿæˆ"
            exit 1
          fi

          echo "å¾®ä¿¡å…¬ä¼—å·æ ¼å¼å·²ç”Ÿæˆ: $WECHAT_FILE"
      
      - name: Build Hugo site
        run: |
          echo "ğŸ—ï¸ æ„å»ºHugoç½‘ç«™..."
          hugo --minify
      
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
          publish_branch: gh-pages
          force_orphan: true
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
          commit_message: 'ğŸš€ è‡ªåŠ¨å‘å¸ƒæ–‡ç« : ${{ steps.topic.outputs.topic }} [$(date +%Y%m%d-%H%M%S)]'
      
      - name: Generate deployment report
        run: |
          echo "# è‡ªåŠ¨å‘å¸ƒæŠ¥å‘Š" > deployment-report.md
          echo "ç”Ÿæˆæ—¶é—´: $(date)" >> deployment-report.md
          echo "" >> deployment-report.md
          
          echo "## ğŸ“‹ å‘å¸ƒè¯¦æƒ…" >> deployment-report.md
          echo "- æ–‡ç« ä¸»é¢˜: ${{ steps.topic.outputs.topic }}" >> deployment-report.md
          echo "- ç”Ÿæˆæ—¶é—´: ${{ steps.topic.outputs.timestamp }}" >> deployment-report.md
          echo "- åŸå§‹æ–‡ç« : ${{ steps.generate.outputs.original_file }}" >> deployment-report.md
          echo "- å¾®ä¿¡å…¬ä¼—å·æ ¼å¼: ${{ steps.generate.outputs.wechat_file }}" >> deployment-report.md
          echo "" >> deployment-report.md
          
          echo "## ğŸŒ è®¿é—®é“¾æ¥" >> deployment-report.md
          echo "- åšå®¢é¦–é¡µ: ${BLOG_URL}" >> deployment-report.md
          FILENAME="${{ steps.topic.outputs.filename }}"
          echo "- æ–‡ç« é¡µé¢: ${BLOG_URL}/posts/${FILENAME}/" >> deployment-report.md
          echo "" >> deployment-report.md
          
          echo "## â° ä¸‹æ¬¡å‘å¸ƒæ—¶é—´" >> deployment-report.md
          echo "ç³»ç»Ÿå°†åœ¨ä»¥ä¸‹æ—¶é—´è‡ªåŠ¨å‘å¸ƒæ–°æ–‡ç« ï¼š" >> deployment-report.md
          echo "- 08:00 (åŒ—äº¬æ—¶é—´)" >> deployment-report.md
          echo "- 12:00 (åŒ—äº¬æ—¶é—´)" >> deployment-report.md
          echo "- 18:00 (åŒ—äº¬æ—¶é—´)" >> deployment-report.md
          echo "- 21:00 (åŒ—äº¬æ—¶é—´)" >> deployment-report.md
          echo "" >> deployment-report.md
          
          echo "## ğŸ”§ æ‰‹åŠ¨è§¦å‘" >> deployment-report.md
          echo "å¦‚éœ€ç«‹å³å‘å¸ƒæ–‡ç« ï¼Œå¯åœ¨GitHub Actionsé¡µé¢æ‰‹åŠ¨è§¦å‘æ­¤å·¥ä½œæµã€‚" >> deployment-report.md
          
          cat deployment-report.md
      
      - name: Upload artifacts
        uses: actions/upload-artifact@v4
        with:
          name: published-articles
          path: |
            content/posts/*.md
            deployment-report.md
          retention-days: 7
      
      - name: Send success notification
        if: success()
        run: |
          echo "âœ… æ–‡ç« å‘å¸ƒæˆåŠŸï¼"
          echo "ä¸»é¢˜: ${{ steps.topic.outputs.topic }}"
          echo "æ—¶é—´: $(date)"
          echo "åšå®¢åœ°å€: ${BLOG_URL}"
          echo "æ–‡ç« é“¾æ¥: ${BLOG_URL}/posts/${{ steps.topic.outputs.filename }}/"