name: Direct Feedback

on:
  workflow_dispatch:
    inputs:
      action:
        description: 'æ“ä½œç±»åž‹'
        required: false
        default: 'check'
        type: choice
        options:
          - check
          - generate

jobs:
  feedback:
    runs-on: ubuntu-latest
    steps:
      - name: Check Current Status
        run: |
          echo "ðŸŽ¯ ç›´æŽ¥åé¦ˆç³»ç»Ÿ"
          echo "================"
          echo ""
          echo "ðŸ“Š ç³»ç»ŸçŠ¶æ€æ£€æŸ¥"
          echo "å·¥ä½œæµ: Direct Feedback"
          echo "è¿è¡ŒID: ${{ github.run_id }}"
          echo "æ—¶é—´: $(date)"
          echo "æ“ä½œ: ${{ github.event.inputs.action }}"
          echo ""
      
      - name: Generate Article if Requested
        if: github.event.inputs.action == 'generate'
        run: |
          echo "ðŸ“ ç”Ÿæˆåé¦ˆæµ‹è¯•æ–‡ç« ..."
          mkdir -p content/posts
          
          TIMESTAMP=$(date +%Y%m%d-%H%M%S)
          
          cat > content/posts/feedback-${TIMESTAMP}.md << 'EOF'
          ---
          title: "ç›´æŽ¥åé¦ˆæµ‹è¯• - ${TIMESTAMP}"
          date: $(date -Iseconds)
          draft: false
          tags: ["åé¦ˆ", "ç›´æŽ¥", "æµ‹è¯•"]
          categories: ["åé¦ˆæµ‹è¯•"]
          slug: "feedback-${TIMESTAMP}"
          ---
          
          # ç›´æŽ¥åé¦ˆæµ‹è¯•æ–‡ç« 
          
          **æ—¶é—´æˆ³**: ${TIMESTAMP}
          **ç›®çš„**: æµ‹è¯•ç›´æŽ¥åé¦ˆç³»ç»Ÿ
          
          ## æµ‹è¯•æµç¨‹
          1. å·¥ä½œæµç”Ÿæˆæ­¤æ–‡ç« 
          2. æäº¤åˆ°GitHubä»“åº“
          3. è§¦å‘è‡ªåŠ¨éƒ¨ç½²
          4. æ£€æŸ¥æ˜¯å¦å‘å¸ƒæˆåŠŸ
          
          ## é¢„æœŸç»“æžœ
          - âœ… æ–‡ç« å‡ºçŽ°åœ¨åšå®¢ä¸­
          - âœ… åé¦ˆç³»ç»Ÿç¡®è®¤å‘å¸ƒ
          - âœ… ç³»ç»Ÿå·¥ä½œæ­£å¸¸
          
          ---
          *ç›´æŽ¥åé¦ˆæµ‹è¯•*
          *ç”Ÿæˆæ—¶é—´: ${TIMESTAMP}*
          EOF
          
          echo "âœ… æ–‡ç« å·²ç”Ÿæˆ: feedback-${TIMESTAMP}.md"
          echo "é¢„æœŸURL: https://gsaecy.github.io/posts/feedback-${TIMESTAMP}/"
      
      - name: Commit if Generated
        if: github.event.inputs.action == 'generate'
        run: |
          echo "ðŸ’¾ æäº¤æ–‡ç« åˆ°ä»“åº“..."
          git config --global user.name "GitHub Actions Bot"
          git config --global user.email "actions-bot@github.com"
          git add content/posts/
          git commit -m "ðŸ“Š ç›´æŽ¥åé¦ˆæµ‹è¯•æ–‡ç«  [${TIMESTAMP}]"
          git push origin main
          
          echo "âœ… æ–‡ç« å·²æäº¤"
          echo "è¿™å°†è‡ªåŠ¨è§¦å‘Hugoéƒ¨ç½²"
      
      - name: Give Direct Answer
        run: |
          echo ""
          echo "â“ æ ¸å¿ƒé—®é¢˜ç­”æ¡ˆ"
          echo "================"
          echo ""
          
          if [ "${{ github.event.inputs.action }}" = "generate" ]; then
            echo "ðŸ”´ æœ‰æ²¡æœ‰å‘å¸ƒæ–°æ–‡ç« ï¼Ÿ"
            echo ""
            echo "ðŸ”„ **å½“å‰çŠ¶æ€**: å·²ç”Ÿæˆå¹¶æäº¤ï¼Œéƒ¨ç½²è¿›è¡Œä¸­"
            echo ""
            echo "### è¯¦ç»†ä¿¡æ¯:"
            echo "1. âœ… æ–‡ç« ç”Ÿæˆ: å®Œæˆ"
            echo "2. âœ… æäº¤ä»“åº“: å®Œæˆ" 
            echo "3. ðŸ”„ éƒ¨ç½²è§¦å‘: è¿›è¡Œä¸­"
            echo "4. â³ å‘å¸ƒæ£€æŸ¥: ç­‰å¾…1-2åˆ†é’Ÿ"
            echo ""
            echo "### æ£€æŸ¥æ–¹æ³•:"
            echo "1. ç­‰å¾…2åˆ†é’Ÿ"
            echo "2. è®¿é—®: https://gsaecy.github.io"
            echo "3. æŸ¥çœ‹æœ€æ–°æ–‡ç« "
            echo ""
            echo "### æ–‡ç« ä¿¡æ¯:"
            echo "- æ—¶é—´æˆ³: $(date +%Y%m%d-%H%M%S)"
            echo "- é¢„æœŸURL: https://gsaecy.github.io/posts/feedback-$(date +%Y%m%d-%H%M%S)/"
          else
            echo "ðŸ”´ æœ‰æ²¡æœ‰å‘å¸ƒæ–°æ–‡ç« ï¼Ÿ"
            echo ""
            echo "ðŸ“‹ **ç­”æ¡ˆ**: è¯·æ‰‹åŠ¨æ£€æŸ¥åšå®¢"
            echo ""
            echo "### æ£€æŸ¥æ­¥éª¤:"
            echo "1. è®¿é—®: https://gsaecy.github.io"
            echo "2. æŸ¥çœ‹æ˜¯å¦æœ‰æ–°æ–‡ç« "
            echo "3. æˆ–è¿è¡Œ generate æ¨¡å¼æµ‹è¯•"
            echo ""
            echo "### ç³»ç»ŸçŠ¶æ€:"
            echo "- å·¥ä½œæµ: æ­£å¸¸è¿è¡Œ"
            echo "- æ¨¡å¼: ä»…æ£€æŸ¥"
            echo "- å»ºè®®: ä½¿ç”¨ generate æ¨¡å¼æµ‹è¯•å‘å¸ƒ"
          fi
          
          echo ""
          echo "---"
          echo "åé¦ˆæ—¶é—´: $(date)"
          echo "åé¦ˆID: FB-$(date +%Y%m%d-%H%M%S)"