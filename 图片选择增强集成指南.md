# 图片选择增强集成模板

## 核心改进

### 1. 关键词提取优化
- 基于文章标题和行业提取关键词
- 考虑中英文混合内容
- 行业特定词汇增强

### 2. 查询生成优化  
- 组合相关关键词
- 行业特定查询
- 英文查询优先（API兼容性）

### 3. 相关性评分
- 关键词匹配度
- 行业相关性
- 图片标题和描述分析

## 集成步骤

### 步骤1: 更新 extract_queries 函数
```python
def extract_queries_enhanced(md_text: str, default_industry: str = "technology") -> List[str]:
    """增强版查询提取"""
    
    # 提取行业信息
    industry = extract_industry_from_frontmatter(md_text) or default_industry
    
    # 提取关键词
    keywords = extract_article_keywords_simple(md_text, industry)
    
    # 生成查询
    queries = generate_search_queries_simple(keywords, industry)
    
    return queries
```

### 步骤2: 更新图片选择逻辑
```python
def select_images_with_relevance(images: List[Dict], keywords: List[str], industry: str) -> List[Dict]:
    """基于相关性选择图片"""
    
    scored_images = []
    for img in images:
        score = calculate_relevance_simple(
            img.get('title', ''),
            img.get('description', ''),
            keywords,
            industry
        )
        img['relevance_score'] = score
        scored_images.append(img)
    
    # 按评分排序
    scored_images.sort(key=lambda x: x['relevance_score'], reverse=True)
    
    return scored_images[:2]  # 返回最佳2张图片
```

### 步骤3: 集成到现有流程
1. 在 `auto_add_public_images.py` 中替换 `extract_queries` 函数
2. 在图片选择后添加相关性评分
3. 基于评分选择最佳图片

## 测试验证

### 单元测试
```python
def test_enhanced_image_selection():
    # 测试不同行业的查询生成
    # 测试相关性评分
    # 验证图片选择结果
```

### 集成测试
1. 使用真实文章测试
2. 对比新旧版本结果
3. 验证图片相关性改进
